# Strings beginning with * seem to precipitate a syntax error...
trigger:
  branches:
    include:
    - master
    - 0.*_maintenance
  tags:
    include:
    - 0.*

jobs :

   # We build on linux using a Docker container generated by GafferHQ/build.
   # We have to use a manual matrix as single job + strategy doesn't allow for
   # conditional parameters. We have to specify `container` on linux, but not
   # for mac. Specifying an empty container breaks validation earlier on in the
   # job setup phase, a valid image name breaks on mac as docker isn't available.

  - template: config/azure/build.yaml
    parameters:
      name: Centos
      buildType: RELEASE
      vmImage: 'Ubuntu-16.04'
      container: 'gafferhq/build:1.1.0'
      publish: true

  - template: config/azure/build.yaml
    parameters:
      name: Centos
      buildType: DEBUG
      vmImage: 'Ubuntu-16.04'
      container: 'gafferhq/build:1.1.0'

  - template: config/azure/build.yaml
    parameters:
      name: MacOS
      vmImage: 'macOS-10.14'
      publish: true

